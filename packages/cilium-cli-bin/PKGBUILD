# Maintainer: Eric Kerst <eric@test.nl>

pkgname=cilium-cli-bin
pkgver=v0.18.7
pkgrel=1
_srcname=cilium
_srcver=0.18.7
pkgdesc="install, manage & troubleshoot Kubernetes clusters running Cilium"
url="https://github.com/cilium/cilium-cli"
arch=("x86_64" "aarch64")
license=("Apache-2.0")
optdepends=('bash-completion: auto-completion for cilium in Bash'
			      'fish-completion: auto-completion for cilium in Fish'
            'zsh-completions: auto-completion for cilium in ZSH')
source_x86_64=(
  "${_srcname}-linux_amd64.tar.gz::https://github.com/cilium/cilium-cli/releases/download/v${_srcver}/${_srcname}-linux-amd64.tar.gz"
)
source_aarch64=(
  "${_srcname}-linux_arm64.tar.gz::https://github.com/cilium/cilium-cli/releases/download/v${_srcver}/${_srcname}-linux-arm64.tar.gz"
)
sha256sums_x86_64=(
  7f5ff96f1793ee389ef77435a72debf122f5ec253d41418fca99d2c21472016a
)
sha256sums_aarch64=(
  dbaa2ab4b1969f4402adf430d6a1bd914c5ab52475ec68f50b3af6fa7fe2fecc
)

package() {
	install -Dm755 ${_srcname} "${pkgdir}/usr/bin/${_srcname}"

    "${pkgdir}/usr/bin/${_srcname}" completion bash | install -Dm644 /dev/stdin "${pkgdir}/usr/share/bash-completion/completions/${_srcname}"
    "${pkgdir}/usr/bin/${_srcname}" completion fish | install -Dm644 /dev/stdin "${pkgdir}/usr/share/fish/vendor_completions.d/${_srcname}.fish"
    "${pkgdir}/usr/bin/${_srcname}" completion zsh | install -Dm644 /dev/stdin "${pkgdir}/usr/share/zsh/site-functions/_${_srcname}"
}
